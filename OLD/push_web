#/bin/sh
# $Id: push_web,v 1.30 2011/02/03 10:37:03 prod Exp $

source /home/prod/.bash_profile

CMD="cvs export -D now -d "

# Production environment (All except twenga.com)
doprod() {
PROD="/home/httpd/www.twenga"
PRODTMP=`mktemp -d /tmp/twenga0.XXXXXX`
cd $PRODTMP
echo Updating files in `pwd`
$CMD html twengaweb/web/html/
$CMD inc twengaweb/web/inc/
$CMD languages twengaweb/web/languages/
$CMD smarty twengaweb/web/smarty
cp -R $PRODTMP/* $PROD
rm -rf $PRODTMP
}

# Twenga.com
dotwengacom() {
PROD="/home/httpd/www.twenga.com"
PRODTMP=`mktemp -d /tmp/twenga0.XXXXXX`
cd $PRODTMP
echo Updating files in `pwd`
$CMD html twengaweb/twenga.com/html/
cp -R $PRODTMP/* $PROD
rm -rf $PRODTMP
}

# Merchant environment
domerchant() {
PROD="/home/httpd/merchant.twenga.com"
PRODTMP=`mktemp -d /tmp/merchant-twenga0.XXXXXX`
cd $PRODTMP
echo Updating files in `pwd`
$CMD html twengaweb/merchant/html/
$CMD inc twengaweb/merchant/inc/
$CMD languages twengaweb/merchant/languages/
$CMD smarty twengaweb/merchant/smarty
cp -R $PRODTMP/* $PROD
rm -rf $PRODTMP
}

# Common environment
docommon() {
PROD="/home/httpd"
PRODTMP=`mktemp -d /tmp/common-twenga0.XXXXXX`
cd $PRODTMP
echo Updating files in `pwd`
$CMD twenga-common twengaweb/common
cp -R $PRODTMP/* $PROD
rm -rf $PRODTMP
}

# Administration environment
doadmin() {
PROD="/home/prod/twengaweb/admin/*"
ADMIN="/home/httpd/admin.twenga.com/"

echo "Updating files in" $ADMIN

cp -rf $PROD $ADMIN
}


if [ "$1" = "common" ]; then
		docommon;
else
if [ "$1" = "web" ]; then
		doprod;
		docommon;
else
if [ "$1" = "admin" ]; then
	doadmin;
else
if [ "$1" = "merchant" ]; then
	domerchant;
	docommon;
else
	echo "Please specify either web, common, merchant or admin !"
	exit 1
fi
fi
fi
fi

$HOME/twenga/tools/sched_deploy_webcode fs3

exit $?

